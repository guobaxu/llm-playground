# 反应场数据展示工具 (Streamlit版本)

这是一个基于Streamlit开发的反应场数据展示工具，用于对比展示输入内容、标准输出和模型预测结果。

## 功能特性

- 📁 **文件上传**: 支持JSON文件上传
- 📊 **三栏对比**: 同时展示输入内容、标准输出和模型预测
- 📈 **数据统计**: 显示总项目数和完成率
- 📋 **记录选择**: 支持单条记录查看，可选择特定记录进行详细分析
- 💬 **评论功能**: 为每条记录添加评论，支持时间戳和内容管理
- ✏️ **内联编辑功能**: 直接在展示页面中编辑输入内容、标准输出和模型预测
- 💾 **数据持久化**: 自动保存修改和评论数据到本地文件
- 📥 **数据导出**: 支持CSV、JSON和评论数据导出
- 🏷️ **记录ID显示**: 在选择记录时显示每条记录的ID信息
- 💾 **原文件保存**: 支持保存到原JSON文件（带"已校对"后缀）
- 📋 **数据概览**: 表格形式展示所有数据
- 🎨 **美观界面**: 现代化的UI设计

## 安装和运行

### 1. 安装依赖

```bash
pip install -r streamlit_requirements.txt
```

### 2. 运行应用

```bash
streamlit run reaction_field_viewer.py
```

### 3. 访问应用

应用将在浏览器中自动打开，默认地址为：`http://localhost:8501`

## 使用方法

1. **上传JSON文件**: 点击"选择JSON文件"按钮，选择包含反应场数据的JSON文件
2. **选择记录**: 使用下拉菜单或导航按钮选择要查看的特定记录
3. **查看数据**: 应用会展示选中记录的三栏对比数据
4. **添加评论**: 在评论功能区域为记录添加评论和备注
5. **内联编辑**: 点击"编辑"按钮直接在展示页面中修改内容
6. **保存修改**: 在编辑模式下点击"保存修改"按钮保存您的更改
7. **保存到原文件**: 点击"保存到原文件"按钮，生成带"已校对"后缀的文件
8. **导出数据**: 可以下载CSV、JSON或评论数据文件
9. **查看统计**: 在页面顶部查看数据统计信息

## JSON文件格式

应用期望的JSON文件格式如下：

```json
[
  {
    "input": [
      {
        "role": "user",
        "content": "请分析以下反应场数据: {\"reaction_type\": \"oxidation\", \"conditions\": \"室温\"}"
      }
    ],
    "output": {
      "reaction_field": "氧化反应",
      "conditions": "室温条件"
    },
    "predict_output": {
      "reaction_field": "氧化反应",
      "conditions": "室温条件"
    }
  }
]
```

## 数据存储格式

### 评论数据格式 (comments_data.json)
```json
{
  "record_0": [
    {
      "content": "这个反应场分析很准确",
      "timestamp": "2024-01-15 14:30:25"
    }
  ],
  "record_1": [
    {
      "content": "需要进一步验证条件",
      "timestamp": "2024-01-15 15:45:10"
    }
  ]
}
```

### 修改数据格式 (modified_data.json)
```json
[
  {
    "input": [...],
    "output": {...},
    "predict_output": {...},
    "last_modified": "2024-01-15 16:20:30"
  }
]
```

## 主要改进

相比原HTML版本，Streamlit版本具有以下优势：

- ✅ **更好的交互性**: 支持文件上传、数据导出等交互功能
- ✅ **记录选择**: 支持单条记录查看，提高工作效率
- ✅ **评论系统**: 支持为每条记录添加评论和备注
- ✅ **内联编辑功能**: 直接在展示页面中编辑数据，无需切换界面
- ✅ **数据持久化**: 自动保存修改和评论到本地文件
- ✅ **响应式设计**: 自动适配不同屏幕尺寸
- ✅ **数据处理**: 内置pandas支持，便于数据分析
- ✅ **部署友好**: 易于部署到云平台
- ✅ **扩展性强**: 可以轻松添加新功能

## 技术栈

- **Streamlit**: Web应用框架
- **Pandas**: 数据处理
- **JSON**: 数据格式
- **HTML/CSS**: 界面样式

## 注意事项

- 确保JSON文件格式正确
- 建议使用现代浏览器以获得最佳体验
- 大文件可能需要较长加载时间
